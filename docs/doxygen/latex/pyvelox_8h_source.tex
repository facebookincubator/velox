\hypertarget{pyvelox_8h_source}{}\doxysection{pyvelox.\+h}
\label{pyvelox_8h_source}\index{/home/asus/github/fork/velox/pyvelox/pyvelox.h@{/home/asus/github/fork/velox/pyvelox/pyvelox.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright (c) Facebook, Inc. and its affiliates.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{ * you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *     http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{11 \textcolor{comment}{ * distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{12 \textcolor{comment}{ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{13 \textcolor{comment}{ * See the License for the specific language governing permissions and}}
\DoxyCodeLine{14 \textcolor{comment}{ * limitations under the License.}}
\DoxyCodeLine{15 \textcolor{comment}{ */}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <pybind11/pybind11.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <pybind11/stl.h>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <pybind11/stl\_bind.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <velox/type/Type.h>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{namespace }facebook::velox::py \{}
\DoxyCodeLine{25 }
\DoxyCodeLine{31 }
\DoxyCodeLine{33 std::string \mbox{\hyperlink{group__type_gabc79f16e7823ab840cb02f08d4c578d1}{serializeType}}(\textcolor{keyword}{const} std::shared\_ptr<const velox::Type>\& type);}
\DoxyCodeLine{34 }
\DoxyCodeLine{49 \textcolor{comment}{// Inlining these bindings since adding them to the cpp file results in a}}
\DoxyCodeLine{50 \textcolor{comment}{// ASAN error.}}
\DoxyCodeLine{51 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{group__type_gacb67e389d06aff815aa745a0221f5a56}{addVeloxBindings}}(pybind11::module\& m, \textcolor{keywordtype}{bool} asLocalModule = \textcolor{keyword}{true}) \{}
\DoxyCodeLine{52   \textcolor{keyword}{using namespace }velox;}
\DoxyCodeLine{53   \textcolor{keyword}{namespace }py = pybind11;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55   \textcolor{comment}{// Add TypeKind enum.}}
\DoxyCodeLine{56   py::enum\_<velox::TypeKind>(m, \textcolor{stringliteral}{"{}TypeKind"{}}, py::module\_local(asLocalModule))}
\DoxyCodeLine{57       .value(\textcolor{stringliteral}{"{}BOOLEAN"{}}, velox::TypeKind::BOOLEAN)}
\DoxyCodeLine{58       .value(\textcolor{stringliteral}{"{}TINYINT"{}}, velox::TypeKind::TINYINT)}
\DoxyCodeLine{59       .value(\textcolor{stringliteral}{"{}SMALLINT"{}}, velox::TypeKind::SMALLINT)}
\DoxyCodeLine{60       .value(\textcolor{stringliteral}{"{}INTEGER"{}}, velox::TypeKind::INTEGER)}
\DoxyCodeLine{61       .value(\textcolor{stringliteral}{"{}BIGINT"{}}, velox::TypeKind::BIGINT)}
\DoxyCodeLine{62       .value(\textcolor{stringliteral}{"{}REAL"{}}, velox::TypeKind::REAL)}
\DoxyCodeLine{63       .value(\textcolor{stringliteral}{"{}DOUBLE"{}}, velox::TypeKind::DOUBLE)}
\DoxyCodeLine{64       .value(\textcolor{stringliteral}{"{}VARCHAR"{}}, velox::TypeKind::VARCHAR)}
\DoxyCodeLine{65       .value(\textcolor{stringliteral}{"{}VARBINARY"{}}, velox::TypeKind::VARBINARY)}
\DoxyCodeLine{66       .value(\textcolor{stringliteral}{"{}TIMESTAMP"{}}, velox::TypeKind::TIMESTAMP)}
\DoxyCodeLine{67       .value(\textcolor{stringliteral}{"{}OPAQUE"{}}, velox::TypeKind::OPAQUE)}
\DoxyCodeLine{68       .value(\textcolor{stringliteral}{"{}ARRAY"{}}, velox::TypeKind::ARRAY)}
\DoxyCodeLine{69       .value(\textcolor{stringliteral}{"{}MAP"{}}, velox::TypeKind::MAP)}
\DoxyCodeLine{70       .value(\textcolor{stringliteral}{"{}ROW"{}}, velox::TypeKind::ROW)}
\DoxyCodeLine{71       .export\_values();}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   \textcolor{comment}{// Create VeloxType bound to velox::Type.}}
\DoxyCodeLine{74   py::class\_<Type, std::shared\_ptr<Type>> type(}
\DoxyCodeLine{75       m, \textcolor{stringliteral}{"{}VeloxType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   \textcolor{comment}{// Adding all the derived types of Type here.}}
\DoxyCodeLine{78   py::class\_<BooleanType, Type, std::shared\_ptr<BooleanType>> booleanType(}
\DoxyCodeLine{79       m, \textcolor{stringliteral}{"{}BooleanType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{80   py::class\_<IntegerType, Type, std::shared\_ptr<IntegerType>> integerType(}
\DoxyCodeLine{81       m, \textcolor{stringliteral}{"{}IntegerType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{82   py::class\_<BigintType, Type, std::shared\_ptr<BigintType>> bigintType(}
\DoxyCodeLine{83       m, \textcolor{stringliteral}{"{}BigintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{84   py::class\_<SmallintType, Type, std::shared\_ptr<SmallintType>> smallintType(}
\DoxyCodeLine{85       m, \textcolor{stringliteral}{"{}SmallintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{86   py::class\_<TinyintType, Type, std::shared\_ptr<TinyintType>> tinyintType(}
\DoxyCodeLine{87       m, \textcolor{stringliteral}{"{}TinyintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{88   py::class\_<RealType, Type, std::shared\_ptr<RealType>> realType(}
\DoxyCodeLine{89       m, \textcolor{stringliteral}{"{}RealType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{90   py::class\_<DoubleType, Type, std::shared\_ptr<DoubleType>> doubleType(}
\DoxyCodeLine{91       m, \textcolor{stringliteral}{"{}DoubleType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{92   py::class\_<TimestampType, Type, std::shared\_ptr<TimestampType>> timestampType(}
\DoxyCodeLine{93       m, \textcolor{stringliteral}{"{}TimestampType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{94   py::class\_<VarcharType, Type, std::shared\_ptr<VarcharType>> varcharType(}
\DoxyCodeLine{95       m, \textcolor{stringliteral}{"{}VarcharType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{96   py::class\_<VarbinaryType, Type, std::shared\_ptr<VarbinaryType>> varbinaryType(}
\DoxyCodeLine{97       m, \textcolor{stringliteral}{"{}VarbinaryType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{98   py::class\_<ArrayType, Type, std::shared\_ptr<ArrayType>> arrayType(}
\DoxyCodeLine{99       m, \textcolor{stringliteral}{"{}ArrayType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{100   py::class\_<MapType, Type, std::shared\_ptr<MapType>> mapType(}
\DoxyCodeLine{101       m, \textcolor{stringliteral}{"{}MapType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{102   py::class\_<RowType, Type, std::shared\_ptr<RowType>> rowType(}
\DoxyCodeLine{103       m, \textcolor{stringliteral}{"{}RowType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{104   py::class\_<FixedSizeArrayType, Type, std::shared\_ptr<FixedSizeArrayType>>}
\DoxyCodeLine{105       fixedArrayType(m, \textcolor{stringliteral}{"{}FixedSizeArrayType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{106 }
\DoxyCodeLine{107   \textcolor{comment}{// Basic operations on Type.}}
\DoxyCodeLine{108   type.def(\textcolor{stringliteral}{"{}\_\_str\_\_"{}}, \&Type::toString);}
\DoxyCodeLine{109   \textcolor{comment}{// Gcc doesnt support the below kind of templatization.}}
\DoxyCodeLine{110 \textcolor{preprocessor}{\#if defined(\_\_clang\_\_)}}
\DoxyCodeLine{111   \textcolor{comment}{// Adds equality and inequality comparison operators.}}
\DoxyCodeLine{112   type.def(py::self == py::self);}
\DoxyCodeLine{113   type.def(py::self != py::self);}
\DoxyCodeLine{114 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{115   type.def(}
\DoxyCodeLine{116       \textcolor{stringliteral}{"{}cpp\_size\_in\_bytes"{}},}
\DoxyCodeLine{117       \&Type::cppSizeInBytes,}
\DoxyCodeLine{118       \textcolor{stringliteral}{"{}Return the C++ size in bytes"{}});}
\DoxyCodeLine{119   type.def(}
\DoxyCodeLine{120       \textcolor{stringliteral}{"{}is\_fixed\_width"{}},}
\DoxyCodeLine{121       \&Type::isFixedWidth,}
\DoxyCodeLine{122       \textcolor{stringliteral}{"{}Check if the type is fixed width"{}});}
\DoxyCodeLine{123   type.def(}
\DoxyCodeLine{124       \textcolor{stringliteral}{"{}is\_primitive\_type"{}},}
\DoxyCodeLine{125       \&Type::isPrimitiveType,}
\DoxyCodeLine{126       \textcolor{stringliteral}{"{}Check if the type is a primitive type"{}});}
\DoxyCodeLine{127   type.def(\textcolor{stringliteral}{"{}kind"{}}, \&Type::kind, \textcolor{stringliteral}{"{}Returns the kind of the type"{}});}
\DoxyCodeLine{128   type.def(\textcolor{stringliteral}{"{}serialize"{}}, \&\mbox{\hyperlink{group__type_gabc79f16e7823ab840cb02f08d4c578d1}{serializeType}}, \textcolor{stringliteral}{"{}Serializes the type as JSON"{}});}
\DoxyCodeLine{129 }
\DoxyCodeLine{130   booleanType.def(py::init());}
\DoxyCodeLine{131   tinyintType.def(py::init());}
\DoxyCodeLine{132   smallintType.def(py::init());}
\DoxyCodeLine{133   integerType.def(py::init());}
\DoxyCodeLine{134   bigintType.def(py::init());}
\DoxyCodeLine{135   realType.def(py::init());}
\DoxyCodeLine{136   doubleType.def(py::init());}
\DoxyCodeLine{137   varcharType.def(py::init());}
\DoxyCodeLine{138   varbinaryType.def(py::init());}
\DoxyCodeLine{139   timestampType.def(py::init());}
\DoxyCodeLine{140   arrayType.def(py::init<std::shared\_ptr<Type>>());}
\DoxyCodeLine{141   arrayType.def(}
\DoxyCodeLine{142       \textcolor{stringliteral}{"{}element\_type"{}}, \&ArrayType::elementType, \textcolor{stringliteral}{"{}Return the element type"{}});}
\DoxyCodeLine{143   fixedArrayType.def(py::init<int, velox::TypePtr>())}
\DoxyCodeLine{144       .def(\textcolor{stringliteral}{"{}element\_type"{}}, \&velox::FixedSizeArrayType::elementType)}
\DoxyCodeLine{145       .def(\textcolor{stringliteral}{"{}fixed\_width"{}}, \&velox::FixedSizeArrayType::fixedElementsWidth);}
\DoxyCodeLine{146   mapType.def(py::init<std::shared\_ptr<Type>, std::shared\_ptr<Type>>());}
\DoxyCodeLine{147   mapType.def(\textcolor{stringliteral}{"{}key\_type"{}}, \&MapType::keyType, \textcolor{stringliteral}{"{}Return the key type"{}});}
\DoxyCodeLine{148   mapType.def(\textcolor{stringliteral}{"{}value\_type"{}}, \&MapType::valueType, \textcolor{stringliteral}{"{}Return the value type"{}});}
\DoxyCodeLine{149 }
\DoxyCodeLine{150   rowType.def(py::init<}
\DoxyCodeLine{151               std::vector<std::string>,}
\DoxyCodeLine{152               std::vector<std::shared\_ptr<const Type>>>());}
\DoxyCodeLine{153   rowType.def(\textcolor{stringliteral}{"{}size"{}}, \&RowType::size, \textcolor{stringliteral}{"{}Return the number of columns"{}});}
\DoxyCodeLine{154   rowType.def(}
\DoxyCodeLine{155       \textcolor{stringliteral}{"{}child\_at"{}},}
\DoxyCodeLine{156       \&RowType::childAt,}
\DoxyCodeLine{157       \textcolor{stringliteral}{"{}Return the type of the column at a given index"{}},}
\DoxyCodeLine{158       py::arg(\textcolor{stringliteral}{"{}idx"{}}));}
\DoxyCodeLine{159   rowType.def(}
\DoxyCodeLine{160       \textcolor{stringliteral}{"{}find\_child"{}},}
\DoxyCodeLine{161       [](\textcolor{keyword}{const} std::shared\_ptr<RowType>\& type, \textcolor{keyword}{const} std::string\& name) \{}
\DoxyCodeLine{162         \textcolor{keywordflow}{return} type-\/>findChild(name);}
\DoxyCodeLine{163       \},}
\DoxyCodeLine{164       \textcolor{stringliteral}{"{}Return the type of the column with the given name"{}},}
\DoxyCodeLine{165       py::arg(\textcolor{stringliteral}{"{}name"{}}));}
\DoxyCodeLine{166   rowType.def(}
\DoxyCodeLine{167       \textcolor{stringliteral}{"{}get\_child\_idx"{}},}
\DoxyCodeLine{168       \&RowType::getChildIdx,}
\DoxyCodeLine{169       \textcolor{stringliteral}{"{}Return the index of the column with the given name"{}},}
\DoxyCodeLine{170       py::arg(\textcolor{stringliteral}{"{}name"{}}));}
\DoxyCodeLine{171   rowType.def(}
\DoxyCodeLine{172       \textcolor{stringliteral}{"{}name\_of"{}},}
\DoxyCodeLine{173       \&RowType::nameOf,}
\DoxyCodeLine{174       \textcolor{stringliteral}{"{}Return the name of the column at the given index"{}},}
\DoxyCodeLine{175       py::arg(\textcolor{stringliteral}{"{}idx"{}}));}
\DoxyCodeLine{176   rowType.def(\textcolor{stringliteral}{"{}names"{}}, \&RowType::names, \textcolor{stringliteral}{"{}Return the names of the columns"{}});}
\DoxyCodeLine{177 \}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \} \textcolor{comment}{// namespace facebook::velox::py}}

\end{DoxyCode}
