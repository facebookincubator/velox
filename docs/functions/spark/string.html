<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>String Functions &#8212; Velox  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css?v=0f882399" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Date and Time Functions" href="datetime.html" />
    <link rel="prev" title="Comparison Functions" href="comparison.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="datetime.html" title="Date and Time Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="comparison.html" title="Comparison Functions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" accesskey="U">Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">String Functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="string-functions">
<h1>String Functions<a class="headerlink" href="#string-functions" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unless specified otherwise, all functions return NULL if at least one of the arguments is NULL.</p>
<p>These functions assume that input strings contain valid UTF-8 encoded Unicode code points.
The behavior is undefined if they are not.</p>
</div>
<dl class="spark function">
<dt class="sig sig-object spark" id="ascii">
<span class="sig-name descname"><span class="pre">ascii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#ascii" title="Link to this definition">¶</a></dt>
<dd><p>Returns unicode code point of the first character of <code class="docutils literal notranslate"><span class="pre">string</span></code>. Returns 0 if <code class="docutils literal notranslate"><span class="pre">string</span></code> is empty.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="base64">
<span class="sig-name descname"><span class="pre">base64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#base64" title="Link to this definition">¶</a></dt>
<dd><p>Converts <code class="docutils literal notranslate"><span class="pre">expr</span></code> to a base 64 string using RFC2045 Base64 transfer encoding for MIME.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">base64</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;U3BhcmsgU1FM&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="bit_length">
<span class="sig-name descname"><span class="pre">bit_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string/binary</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#bit_length" title="Link to this definition">¶</a></dt>
<dd><p>Returns the bit length for the specified string column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">bit_length</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">24</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="char_type_write_side_check">
<span class="sig-name descname"><span class="pre">char_type_write_side_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#char_type_write_side_check" title="Link to this definition">¶</a></dt>
<dd><p>Ensures that input <code class="docutils literal notranslate"><span class="pre">string</span></code> fits within the specified length <code class="docutils literal notranslate"><span class="pre">limit</span></code> in characters by padding or trimming spaces as needed.
If the length of <code class="docutils literal notranslate"><span class="pre">string</span></code> is less than <code class="docutils literal notranslate"><span class="pre">limit</span></code>, it is padded with trailing spaces (ASCII 32) to reach <code class="docutils literal notranslate"><span class="pre">limit</span></code>.
If the length of <code class="docutils literal notranslate"><span class="pre">string</span></code> is greater than <code class="docutils literal notranslate"><span class="pre">limit</span></code>, trailing spaces are trimmed to fit within <code class="docutils literal notranslate"><span class="pre">limit</span></code>.
Throws exception when <code class="docutils literal notranslate"><span class="pre">string</span></code> still exceeds <code class="docutils literal notranslate"><span class="pre">limit</span></code> after trimming trailing spaces or when <code class="docutils literal notranslate"><span class="pre">limit</span></code> is not greater than 0.
Note: This function is not directly callable in Spark SQL, but internally used for length check when writing char type columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Function</span> <span class="n">call</span> <span class="n">examples</span> <span class="p">(</span><span class="n">this</span> <span class="n">function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">directly</span> <span class="nb">callable</span> <span class="ow">in</span> <span class="n">Spark</span> <span class="n">SQL</span><span class="p">)</span><span class="o">.</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abc&quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;ab&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;ab &quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;a  &quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abc  &quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abc&quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;Exceeds allowed length limitation: &#39;3&#39;&quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;世界&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;世界&quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;世&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;世  &quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;世界人&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;Exceeds allowed length limitation: &#39;2&#39;&quot;</span>
<span class="n">char_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;The length limit must be greater than 0.&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="chr">
<span class="sig-name descname"><span class="pre">chr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#chr" title="Link to this definition">¶</a></dt>
<dd><p>Returns the Unicode code point <code class="docutils literal notranslate"><span class="pre">n</span></code> as a single character string.
If <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">0</span></code>, the result is an empty string.
If <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;=</span> <span class="pre">256</span></code>, the result is equivalent to chr(<code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">%</span> <span class="pre">256</span></code>).</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="concat_ws">
<span class="sig-name descname"><span class="pre">concat_ws</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">separator</span></span></em>, <span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">string/array&lt;string&gt;</span></span></em>, <span class="optional">]</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#concat_ws" title="Link to this definition">¶</a></dt>
<dd><p>Returns the concatenation result for <code class="docutils literal notranslate"><span class="pre">string</span></code> and all elements in <code class="docutils literal notranslate"><span class="pre">array&lt;string&gt;</span></code>, separated
by <code class="docutils literal notranslate"><span class="pre">separator</span></code>. The first argument is <code class="docutils literal notranslate"><span class="pre">separator</span></code> whose type is VARCHAR. Then, this function
can take variable number of remaining arguments , and it allows mixed use of <code class="docutils literal notranslate"><span class="pre">string</span></code> type and
<code class="docutils literal notranslate"><span class="pre">array&lt;string&gt;</span></code> type. Skips NULL argument or NULL array element during the concatenation. If
<code class="docutils literal notranslate"><span class="pre">separator</span></code> is NULL, returns NULL, regardless of the following inputs. For non-NULL <code class="docutils literal notranslate"><span class="pre">separator</span></code>,
if no remaining input exists or all remaining inputs are NULL, returns an empty string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;a~b~c&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]);</span> <span class="o">--</span> <span class="s1">&#39;a~b~c~d&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]);</span> <span class="o">--</span> <span class="s1">&#39;a~b~c&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]);</span> <span class="o">--</span> <span class="s1">&#39;~~a~&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="p">[</span><span class="n">NULL</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;a~b&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;&#39;</span>
<span class="n">SELECT</span> <span class="n">concat_ws</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">NULL</span><span class="p">]);</span> <span class="o">--</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="contains">
<span class="sig-name descname"><span class="pre">contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">boolean</span></span></span><a class="headerlink" href="#contains" title="Link to this definition">¶</a></dt>
<dd><p>Returns true if ‘right’ is found in ‘left’. Otherwise, returns false.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;Spark&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;SPARK&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="n">null</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">contains</span><span class="p">(</span><span class="n">x</span><span class="s1">&#39;537061726b2053514c&#39;</span><span class="p">,</span> <span class="n">x</span><span class="s1">&#39;537061726b&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="conv">
<span class="sig-name descname"><span class="pre">conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fromBase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toBase</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#conv" title="Link to this definition">¶</a></dt>
<dd><p>Converts <code class="docutils literal notranslate"><span class="pre">number</span></code> represented as a string from <code class="docutils literal notranslate"><span class="pre">fromBase</span></code> to <code class="docutils literal notranslate"><span class="pre">toBase</span></code>.
<code class="docutils literal notranslate"><span class="pre">fromBase</span></code> must be an INTEGER value between 2 and 36 inclusively. <code class="docutils literal notranslate"><span class="pre">toBase</span></code> must
be an INTEGER value between 2 and 36 inclusively or between -36 and -2 inclusively.
Otherwise, returns NULL.
Returns a signed number if <code class="docutils literal notranslate"><span class="pre">toBase</span></code> is negative. Otherwise, returns an unsigned one.
Returns NULL if <code class="docutils literal notranslate"><span class="pre">number</span></code> is empty.
Skips leading spaces. <code class="docutils literal notranslate"><span class="pre">number</span></code> may contain other characters not valid for <code class="docutils literal notranslate"><span class="pre">fromBase</span></code>.
All characters starting from the first invalid character till the end of the string are
ignored. Only converts valid characters even though <code class="docutils literal notranslate"><span class="pre">fromBase</span></code> = <code class="docutils literal notranslate"><span class="pre">toBase</span></code>. Returns
‘0’ if no valid character is found.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;4&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s1">&#39;-10&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;-16&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;FFFFFFFFFFFFFFFF&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">39</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;B&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s2">&quot;11ABC&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;B&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s2">&quot;11abc&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;11&#39;</span>
<span class="n">SELECT</span> <span class="n">conv</span><span class="p">(</span><span class="s1">&#39;H016F&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;0&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="empty2null">
<span class="sig-name descname"><span class="pre">empty2null</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#empty2null" title="Link to this definition">¶</a></dt>
<dd><p>Returns NULL if <code class="docutils literal notranslate"><span class="pre">input</span></code> is empty. Otherwise, returns <code class="docutils literal notranslate"><span class="pre">input</span></code>.
Note: it’s an internal Spark function used to convert empty value of a partition column,
which is then converted to Hive default partition value <code class="docutils literal notranslate"><span class="pre">__HIVE_DEFAULT_PARTITION__</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">empty2null</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">empty2null</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;abc&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="endswith">
<span class="sig-name descname"><span class="pre">endswith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">boolean</span></span></span><a class="headerlink" href="#endswith" title="Link to this definition">¶</a></dt>
<dd><p>Returns true if ‘left’ ends with ‘right’. Otherwise, returns false.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;js&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="find_in_set">
<span class="sig-name descname"><span class="pre">find_in_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#find_in_set" title="Link to this definition">¶</a></dt>
<dd><p>Returns 1-based index of the given string <code class="docutils literal notranslate"><span class="pre">str</span></code> in the comma-delimited list <code class="docutils literal notranslate"><span class="pre">strArray</span></code>.
Returns 0, if the string was not found or if the given string <code class="docutils literal notranslate"><span class="pre">str</span></code> contains a comma.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="s1">&#39;abc,b,ab,c,def&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">3</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;ab,&#39;</span><span class="p">,</span> <span class="s1">&#39;abc,b,ab,c,def&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;dfg&#39;</span><span class="p">,</span> <span class="s1">&#39;abc,b,ab,c,def&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;123,&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;,123&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;,123&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">find_in_set</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="initcap">
<span class="sig-name descname"><span class="pre">initcap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#initcap" title="Link to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal notranslate"><span class="pre">initcap</span></code> function converts the first character of each word to uppercase
and all other characters in the word to lowercase. It supports UTF-8 multibyte
characters, up to four bytes per character.</p>
<p>A <em>word</em> is defined as a sequence of characters separated by whitespace.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT initcap(&#39;spark sql&#39;); -- Spark Sql
SELECT initcap(&#39;spARK sQL&#39;); -- Spark Sql
SELECT initcap(&#39;123abc DEF!ghi&#39;); -- 123abc Def!ghi
SELECT initcap(&#39;élan vital für alle&#39;); -- Élan Vital Für Alle
SELECT initcap(&#39;hello-world test_case&#39;); -- Hello-world Test_case
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="instr">
<span class="sig-name descname"><span class="pre">instr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substring</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#instr" title="Link to this definition">¶</a></dt>
<dd><p>Returns the starting position of the first instance of <code class="docutils literal notranslate"><span class="pre">substring</span></code> in
<code class="docutils literal notranslate"><span class="pre">string</span></code>. Positions start with <code class="docutils literal notranslate"><span class="pre">1</span></code>. Returns 0 if ‘substring’ is not found.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="left">
<span class="sig-name descname"><span class="pre">left</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#left" title="Link to this definition">¶</a></dt>
<dd><p>Returns the leftmost length characters from the <code class="docutils literal notranslate"><span class="pre">string</span></code>.
If <code class="docutils literal notranslate"><span class="pre">length</span></code> is less or equal than 0 the result is an empty string.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="length">
<span class="sig-name descname"><span class="pre">length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#length" title="Link to this definition">¶</a></dt>
<dd><p>Returns the length of <code class="docutils literal notranslate"><span class="pre">string</span></code> in characters.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="levenshtein">
<span class="sig-name descname"><span class="pre">levenshtein</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string2</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#levenshtein" title="Link to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference external" href="https://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein distance</a> between the two given strings.
If the provided <code class="docutils literal notranslate"><span class="pre">threshold</span></code> is negative, or the levenshtein distance exceeds <code class="docutils literal notranslate"><span class="pre">threshold</span></code>, returns -1.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">levenshtein</span><span class="p">(</span><span class="s1">&#39;kitten&#39;</span><span class="p">,</span> <span class="s1">&#39;sitting&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="mi">3</span>
<span class="n">SELECT</span> <span class="n">levenshtein</span><span class="p">(</span><span class="s1">&#39;kitten&#39;</span><span class="p">,</span> <span class="s1">&#39;sitting&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="mi">3</span>
<span class="n">SELECT</span> <span class="n">levenshtein</span><span class="p">(</span><span class="s1">&#39;kitten&#39;</span><span class="p">,</span> <span class="s1">&#39;sitting&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="locate">
<span class="sig-name descname"><span class="pre">locate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">integer</span></span></span><a class="headerlink" href="#locate" title="Link to this definition">¶</a></dt>
<dd><p>Returns the 1-based position of the first occurrence of <code class="docutils literal notranslate"><span class="pre">substring</span></code> in given <code class="docutils literal notranslate"><span class="pre">string</span></code>
after position <code class="docutils literal notranslate"><span class="pre">start</span></code>. The search is from the beginning of <code class="docutils literal notranslate"><span class="pre">string</span></code> to the end.
<code class="docutils literal notranslate"><span class="pre">start</span></code> is the starting character position in <code class="docutils literal notranslate"><span class="pre">string</span></code> to search for the <code class="docutils literal notranslate"><span class="pre">substring</span></code>.
<code class="docutils literal notranslate"><span class="pre">start</span></code> is 1-based and must be at least 1 and at most the characters number of <code class="docutils literal notranslate"><span class="pre">string</span></code>.
The following rules on special values are applied to follow Spark’s implementation.
They are listed in order of priority:</p>
<p>Returns 0 if <code class="docutils literal notranslate"><span class="pre">start</span></code> is NULL. Returns NULL if <code class="docutils literal notranslate"><span class="pre">substring</span></code> or <code class="docutils literal notranslate"><span class="pre">string</span></code> is NULL.
Returns 0 if <code class="docutils literal notranslate"><span class="pre">start</span></code> is less than 1.
Returns 1 if <code class="docutils literal notranslate"><span class="pre">substring</span></code> is empty.
Returns 0 if <code class="docutils literal notranslate"><span class="pre">start</span></code> is greater than the characters number of <code class="docutils literal notranslate"><span class="pre">string</span></code>.
Returns 0 if <code class="docutils literal notranslate"><span class="pre">substring</span></code> is not found in <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="mi">2</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;aaads&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">1</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="mi">0</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">locate</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\u4FE1</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\u4FE1\u5FF5</span><span class="s1">,</span><span class="se">\u4FE1\u7231</span><span class="s1">,</span><span class="se">\u4FE1\u5E0C\u671B</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="mi">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="lower">
<span class="sig-name descname"><span class="pre">lower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#lower" title="Link to this definition">¶</a></dt>
<dd><p>Returns string with all characters changed to lowercase.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">lower</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">sparksql</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="lpad">
<span class="sig-name descname"><span class="pre">lpad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#lpad" title="Link to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">string</span></code>, left-padded with pad to a length of <code class="docutils literal notranslate"><span class="pre">len</span></code>. If <code class="docutils literal notranslate"><span class="pre">string</span></code> is
longer than <code class="docutils literal notranslate"><span class="pre">len</span></code>, the return value is shortened to <code class="docutils literal notranslate"><span class="pre">len</span></code> characters or bytes.
If <code class="docutils literal notranslate"><span class="pre">pad</span></code> is not specified, <code class="docutils literal notranslate"><span class="pre">string</span></code> will be padded to the left with space characters
if it is a character string, and with zeros if it is a byte sequence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT lpad(&#39;hi&#39;, 5, &#39;??&#39;); -- ???hi
SELECT lpad(&#39;hi&#39;, 1, &#39;??&#39;); -- h
SELECT lpad(&#39;hi&#39;, 4); --   hi
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="ltrim">
<span class="sig-name descname"><span class="pre">ltrim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#ltrim" title="Link to this definition">¶</a></dt>
<dd><p>Removes leading 0x20(space) characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">ltrim</span><span class="p">(</span><span class="s1">&#39;  data  &#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;data  &quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark">
<span class="sig-name descname"><span class="pre">ltrim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trimCharacters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span></dt>
<dd><p>Removes specified leading characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>. The specified character
is any character contained in <code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code>.
<code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code> can be empty and may contain duplicate characters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">ltrim</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;spark&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;ark&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="luhn_check">
<span class="sig-name descname"><span class="pre">luhn_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">boolean</span></span></span><a class="headerlink" href="#luhn_check" title="Link to this definition">¶</a></dt>
<dd><p>Returns true if <code class="docutils literal notranslate"><span class="pre">string</span></code> passes the Luhn algorithm check. Otherwise, returns false.
The Luhn algorithm is a simple check digit formula used to validate a variety of identification numbers,
defined in US patent 2950048A.
Returns NULL if <code class="docutils literal notranslate"><span class="pre">string</span></code> is NULL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">luhn_check</span><span class="p">(</span><span class="s1">&#39;4111111111111111&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="n">luhn_check</span><span class="p">(</span><span class="s1">&#39;378282246310006&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="n">luhn_check</span><span class="p">(</span><span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="mask">
<span class="sig-name descname"><span class="pre">mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">upperChar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowerChar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">digitChar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">otherChar</span></span></em><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#mask" title="Link to this definition">¶</a></dt>
<dd><p>Returns a masked version of the input <code class="docutils literal notranslate"><span class="pre">string</span></code>.
<code class="docutils literal notranslate"><span class="pre">string</span></code>: string value to mask.
<code class="docutils literal notranslate"><span class="pre">upperChar</span></code>: A single character string used to substitute upper case characters. The default is ‘X’. If NULL, upper case characters remain unmasked.
<code class="docutils literal notranslate"><span class="pre">lowerChar</span></code>: A single character string used to substitute lower case characters. The default is ‘x’. If NULL, lower case characters remain unmasked.
<code class="docutils literal notranslate"><span class="pre">digitChar</span></code>: A single character string used to substitute digits. The default is ‘n’. If NULL, digits remain unmasked.
<code class="docutils literal notranslate"><span class="pre">otherChar</span></code>: A single character string used to substitute any other character. The default is NULL, which leaves these characters unmasked.
Any invalid UTF-8 characters present in the input string will be treated as a single other character.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;abcd-EFGH-8765-4321&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;xxxx-XXXX-nnnn-nnnn&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;abcd-EFGH-8765-4321&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;xxxx-QQQQ-nnnn-nnnn&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;XxXXnnn-@$#&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;QxQQnnn-@$#&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;QqQQnnn-@$#&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;QqQQddd-@$#&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;QqQQdddoooo&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;AqCDdddoooo&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;AbCDdddoooo&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;AbCD123oooo&quot;</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
<span class="n">SELECT</span> <span class="n">mask</span><span class="p">(</span><span class="s1">&#39;AbCD123-@$#&#39;</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="n">NULL</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;AbCD123-@$#&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="overlay">
<span class="sig-name descname"><span class="pre">overlay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">same</span> <span class="pre">as</span> <span class="pre">input</span></span></span><a class="headerlink" href="#overlay" title="Link to this definition">¶</a></dt>
<dd><p>Replace a substring of <code class="docutils literal notranslate"><span class="pre">input</span></code> starting at <code class="docutils literal notranslate"><span class="pre">pos</span></code> character with <code class="docutils literal notranslate"><span class="pre">replace</span></code> and
going for rest <code class="docutils literal notranslate"><span class="pre">len</span></code> characters of <code class="docutils literal notranslate"><span class="pre">input</span></code>.
Types of <code class="docutils literal notranslate"><span class="pre">input</span></code> and <code class="docutils literal notranslate"><span class="pre">replace</span></code> must be the same. Supported types are: VARCHAR and VARBINARY.
When <code class="docutils literal notranslate"><span class="pre">input</span></code> types are VARCHAR, <code class="docutils literal notranslate"><span class="pre">len</span></code> and <code class="docutils literal notranslate"><span class="pre">pos</span></code> are specified in characters, otherwise, bytes.
Result is constructed from three parts.
First part is first pos - 1 characters of <code class="docutils literal notranslate"><span class="pre">input</span></code> when <code class="docutils literal notranslate"><span class="pre">pos</span></code> if greater then zero, otherwise, empty string.
Second part is <code class="docutils literal notranslate"><span class="pre">replace</span></code>.
Third part is rest of <code class="docutils literal notranslate"><span class="pre">input</span></code> from indices pos + len which is 1-based,
if <code class="docutils literal notranslate"><span class="pre">len</span></code> is negative, it will be set to size of <code class="docutils literal notranslate"><span class="pre">replace</span></code>,
if pos + len is negative, it refers to -(pos + len)th element before the end of <code class="docutils literal notranslate"><span class="pre">input</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spark_SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;CORE&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spark CORE&quot;</span>
<span class="n">SELECT</span> <span class="n">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;ANSI &#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spark ANSI SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;tructured&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Structured SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">overlay</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;_Sql&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="read_side_padding">
<span class="sig-name descname"><span class="pre">read_side_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#read_side_padding" title="Link to this definition">¶</a></dt>
<dd><p>Right-pads the given string with spaces to the specified length <code class="docutils literal notranslate"><span class="pre">limit</span></code>.
If the string’s length is already greater than or equal to <code class="docutils literal notranslate"><span class="pre">limit</span></code>, it is returned as-is.
Throws an exception if <code class="docutils literal notranslate"><span class="pre">limit</span></code> is not greater than 0.
Note: This function is not directly callable in Spark SQL, but is used internally for reading CHAR type columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Function</span> <span class="n">call</span> <span class="n">examples</span> <span class="p">(</span><span class="n">this</span> <span class="n">function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">directly</span> <span class="nb">callable</span> <span class="ow">in</span> <span class="n">Spark</span> <span class="n">SQL</span><span class="p">)</span><span class="o">.</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;a  &quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abc&quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abcd&quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;世&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;世  &quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;世界&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;世界&quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;Привет&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;Привет  &quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;Γειά&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;Γειά &quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;Приветик&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;Приветик&quot;</span>
<span class="n">read_side_padding</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;The length limit must be greater than 0.&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#repeat" title="Link to this definition">¶</a></dt>
<dd><p>Returns the string which repeats <code class="docutils literal notranslate"><span class="pre">input</span></code> <code class="docutils literal notranslate"><span class="pre">n</span></code> times.
Result size must be less than or equal to 1MB.
If <code class="docutils literal notranslate"><span class="pre">n</span></code> is less than or equal to 0, empty string is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">repeat</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="mi">123123</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replaced</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#replace" title="Link to this definition">¶</a></dt>
<dd><p>Removes all instances of <code class="docutils literal notranslate"><span class="pre">replaced</span></code> from <code class="docutils literal notranslate"><span class="pre">input</span></code>.
If <code class="docutils literal notranslate"><span class="pre">replaced</span></code> is an empty string, returns the original <code class="docutils literal notranslate"><span class="pre">input</span></code> string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">ABCabc</span>
<span class="n">SELECT</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span> <span class="s1">&#39;bc&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">ABCc</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="id0">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replaced</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replacement</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Replaces all instances of <code class="docutils literal notranslate"><span class="pre">replaced</span></code> with <code class="docutils literal notranslate"><span class="pre">replacement</span></code> in <code class="docutils literal notranslate"><span class="pre">input</span></code>.
If <code class="docutils literal notranslate"><span class="pre">replaced</span></code> is an empty string, returns the original <code class="docutils literal notranslate"><span class="pre">input</span></code> string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;DEF&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">ABCabc</span>
<span class="n">SELECT</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">ABC</span>
<span class="n">SELECT</span> <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;ABCabc&#39;</span><span class="p">,</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;DEF&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">ABCDEF</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="reverse">
<span class="sig-name descname"><span class="pre">reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#reverse" title="Link to this definition">¶</a></dt>
<dd><p>Returns input string with characters in reverse order.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="rpad">
<span class="sig-name descname"><span class="pre">rpad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#rpad" title="Link to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">string</span></code>, right-padded with <code class="docutils literal notranslate"><span class="pre">pad</span></code> to a length of <code class="docutils literal notranslate"><span class="pre">len</span></code>.
If <code class="docutils literal notranslate"><span class="pre">string</span></code> is longer than <code class="docutils literal notranslate"><span class="pre">len</span></code>, the return value is shortened to <code class="docutils literal notranslate"><span class="pre">len</span></code> characters.
If <code class="docutils literal notranslate"><span class="pre">pad</span></code> is not specified, <code class="docutils literal notranslate"><span class="pre">string</span></code> will be padded to the right with space characters
if it is a character string, and with zeros if it is a binary string.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT lpad(&#39;hi&#39;, 5, &#39;??&#39;); -- ???hi
SELECT lpad(&#39;hi&#39;, 1, &#39;??&#39;); -- h
SELECT lpad(&#39;hi&#39;, 4); -- hi
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="rtrim">
<span class="sig-name descname"><span class="pre">rtrim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#rtrim" title="Link to this definition">¶</a></dt>
<dd><p>Removes trailing 0x20(space) characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">rtrim</span><span class="p">(</span><span class="s1">&#39;  data  &#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;  data&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark">
<span class="sig-name descname"><span class="pre">rtrim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trimCharacters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span></dt>
<dd><p>Removes specified trailing characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>. The specified character
is any character contained in <code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code>.
<code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code> can be empty and may contain duplicate characters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">rtrim</span><span class="p">(</span><span class="s1">&#39;kr&#39;</span><span class="p">,</span> <span class="s1">&#39;spark&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;spa&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="soundex">
<span class="sig-name descname"><span class="pre">soundex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#soundex" title="Link to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="https://en.wikipedia.org/wiki/Soundex">Soundex code</a> of the string. If first character of <code class="docutils literal notranslate"><span class="pre">string</span></code> is not
a letter, <code class="docutils literal notranslate"><span class="pre">string</span></code> is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">soundex</span><span class="p">(</span><span class="s1">&#39;Miller&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;M460&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">string,</span> <span class="pre">delimiter[,</span> <span class="pre">limit])</span> <span class="pre">-&gt;</span> <span class="pre">array(string</span></em><span class="sig-paren">)</span><a class="headerlink" href="#split" title="Link to this definition">¶</a></dt>
<dd><p>Splits <code class="docutils literal notranslate"><span class="pre">string</span></code> around occurrences that match <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> and returns an array with a length of
at most <code class="docutils literal notranslate"><span class="pre">limit</span></code>. <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> is a string representing regular expression. <code class="docutils literal notranslate"><span class="pre">limit</span></code> is an integer
which controls the number of times the regex is applied. By default, <code class="docutils literal notranslate"><span class="pre">limit</span></code> is -1. When <code class="docutils literal notranslate"><span class="pre">limit</span></code> &gt; 0,
the resulting array’s length will not be more than <code class="docutils literal notranslate"><span class="pre">limit</span></code>, and the resulting array’s last entry will
contain all input beyond the last matched regex. When <code class="docutils literal notranslate"><span class="pre">limit</span></code> &lt;= 0, <code class="docutils literal notranslate"><span class="pre">regex</span></code> will be applied as many
times as possible, and the resulting array can be of any size. When <code class="docutils literal notranslate"><span class="pre">delimiter</span></code> is empty, if <code class="docutils literal notranslate"><span class="pre">limit</span></code>
is smaller than the size of <code class="docutils literal notranslate"><span class="pre">string</span></code>, the resulting array only contains <code class="docutils literal notranslate"><span class="pre">limit</span></code> number of single characters
splitting from <code class="docutils literal notranslate"><span class="pre">string</span></code>, if <code class="docutils literal notranslate"><span class="pre">limit</span></code> is not provided or is larger than the size of <code class="docutils literal notranslate"><span class="pre">string</span></code>, the resulting
array contains all the single characters of <code class="docutils literal notranslate"><span class="pre">string</span></code> and does not include an empty tail character.
The split function align with vanilla spark 3.4+ split function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span> <span class="s1">&#39;[ABC]&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span><span class="s2">&quot;two&quot;</span><span class="p">,</span><span class="s2">&quot;three&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span> <span class="s1">&#39;[ABC]&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span><span class="s2">&quot;twoBthreeC&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;oneAtwoBthreeC&#39;</span><span class="p">,</span> <span class="s1">&#39;[ABC]&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span><span class="s2">&quot;two&quot;</span><span class="p">,</span><span class="s2">&quot;three&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>
<span class="n">SELECT</span> <span class="n">split</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="o">--</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;d&quot;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="startswith">
<span class="sig-name descname"><span class="pre">startswith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">boolean</span></span></span><a class="headerlink" href="#startswith" title="Link to this definition">¶</a></dt>
<dd><p>Returns true if ‘left’ starts with ‘right’. Otherwise, returns false.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;js&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">true</span>
<span class="n">SELECT</span> <span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">false</span>
<span class="n">SELECT</span> <span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;js SQL&#39;</span><span class="p">,</span> <span class="n">null</span><span class="p">);</span> <span class="o">--</span> <span class="n">NULL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="str_to_map">
<span class="sig-name descname"><span class="pre">str_to_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entryDelimiter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyValueDelimiter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#str_to_map" title="Link to this definition">¶</a></dt>
<dd><p>Returns a map by splitting <code class="docutils literal notranslate"><span class="pre">string</span></code> into entries with <code class="docutils literal notranslate"><span class="pre">entryDelimiter</span></code> and splitting
each entry into key/value with <code class="docutils literal notranslate"><span class="pre">keyValueDelimiter</span></code>.
<code class="docutils literal notranslate"><span class="pre">entryDelimiter</span></code> and <code class="docutils literal notranslate"><span class="pre">keyValueDelimiter</span></code> must be constant strings with single ascii
character. Allows <code class="docutils literal notranslate"><span class="pre">keyValueDelimiter</span></code> not found when splitting an entry. Throws exception
when duplicate map keys are found for single row’s result, consistent with Spark’s default
behavior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;a:1,b:2,c:3&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="s2">&quot;3&quot;</span><span class="p">}</span>
<span class="n">SELECT</span> <span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="n">NULL</span><span class="p">}</span>
<span class="n">SELECT</span> <span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">:</span><span class="n">NULL</span><span class="p">}</span>
<span class="n">SELECT</span> <span class="n">str_to_map</span><span class="p">(</span><span class="s1">&#39;a:1,b:2,c:3&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="p">{</span><span class="s2">&quot;a:1&quot;</span><span class="p">:</span><span class="n">NULL</span><span class="p">,</span><span class="s2">&quot;b:2&quot;</span><span class="p">:</span><span class="n">NULL</span><span class="p">,</span><span class="s2">&quot;c:3&quot;</span><span class="p">:</span><span class="n">NULL</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="substring">
<span class="sig-name descname"><span class="pre">substring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#substring" title="Link to this definition">¶</a></dt>
<dd><p>Returns the rest of <code class="docutils literal notranslate"><span class="pre">string</span></code> from the starting position <code class="docutils literal notranslate"><span class="pre">start</span></code>.
Positions start with <code class="docutils literal notranslate"><span class="pre">1</span></code>. A negative starting position is interpreted
as being relative to the end of the string. When the starting position is 0,
the meaning is to refer to the first character.Type of ‘start’ must be an INTEGER.</p>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark">
<span class="sig-name descname"><span class="pre">substring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span></dt>
<dd><p>Returns a substring from <code class="docutils literal notranslate"><span class="pre">string</span></code> of length <code class="docutils literal notranslate"><span class="pre">length</span></code> from the starting
position <code class="docutils literal notranslate"><span class="pre">start</span></code>. Positions start with <code class="docutils literal notranslate"><span class="pre">1</span></code>. A negative starting
position is interpreted as being relative to the end of the string.
When the starting position is 0, the meaning is to refer to the first character.
Type of ‘start’ must be an INTEGER.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="n">Sp</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="n">Sp</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10000</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;k SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spa&quot;</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Sp&quot;</span>
<span class="n">SELECT</span> <span class="n">substring</span><span class="p">(</span><span class="s1">&#39;Spark SQL&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="substring_index">
<span class="sig-name descname"><span class="pre">substring_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">[same</span> <span class="pre">as</span> <span class="pre">string]</span></span></span><a class="headerlink" href="#substring_index" title="Link to this definition">¶</a></dt>
<dd><p>Returns the substring from <code class="docutils literal notranslate"><span class="pre">string</span></code> before <code class="docutils literal notranslate"><span class="pre">count</span></code> occurrences of the delimiter <code class="docutils literal notranslate"><span class="pre">delim</span></code>.
Here the <code class="docutils literal notranslate"><span class="pre">string</span></code> can be VARCHAR or VARBINARY and return type matches type of <code class="docutils literal notranslate"><span class="pre">string</span></code>.
If <code class="docutils literal notranslate"><span class="pre">count</span></code> is positive, returns everything to the left of the final delimiter
(counting from the left). If <code class="docutils literal notranslate"><span class="pre">count</span></code> is negative, returns everything to the right
of the final delimiter (counting from the right). If <code class="docutils literal notranslate"><span class="pre">count</span></code> is 0, returns empty string.
If <code class="docutils literal notranslate"><span class="pre">delim</span></code> is not found or found fewer times than <code class="docutils literal notranslate"><span class="pre">count</span></code>, returns the original input string.
<code class="docutils literal notranslate"><span class="pre">delim</span></code> is case-sensitive. It also takes into account overlapping strings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spark&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;TEST.Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;TEST.Spark&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;TEST.Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;TEST.Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;Spark.SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;TEST.Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;TEST.Spark.SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;TEST.Spark.SQL&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;TEST.Spark.SQL&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;a&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;aaa&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;aaaaa&quot;</span>
<span class="n">SELECT</span> <span class="n">substring_index</span><span class="p">(</span><span class="s1">&#39;aaaaa&#39;</span><span class="p">,</span> <span class="s1">&#39;aa&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;aaaaa&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="to_pretty_string">
<span class="sig-name descname"><span class="pre">to_pretty_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#to_pretty_string" title="Link to this definition">¶</a></dt>
<dd><p>Returns pretty string for <code class="docutils literal notranslate"><span class="pre">x</span></code>. All scalar types are supported.
Adjusts the timestamp input to the given time zone if set through <code class="docutils literal notranslate"><span class="pre">session_timezone</span></code> config.
The result is different from that of casting <code class="docutils literal notranslate"><span class="pre">x</span></code> as string in the following aspects.</p>
<ul class="simple">
<li><p>It prints null input as “NULL” rather than producing null output.</p></li>
<li><p>It prints binary values using the hex format.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;4&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;1.0&quot;</span> <span class="k">as</span> <span class="nb">float</span><span class="p">));</span> <span class="o">--</span> <span class="s2">&quot;1.0&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="s2">&quot;spark&quot;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;spark&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;abcdef&#39;</span> <span class="k">as</span> <span class="n">binary</span><span class="p">));</span> <span class="o">--</span> <span class="s2">&quot;[61 62 63 64 65 66]&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="n">null</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;NULL&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="mi">2347589</span> <span class="k">as</span> <span class="n">timestamp</span><span class="p">));</span> <span class="o">--</span> <span class="s2">&quot;1970-01-28 12:06:29&quot;</span>
<span class="n">SELECT</span> <span class="n">to_pretty_string</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="s1">&#39;2024-05-08&#39;</span> <span class="k">as</span> <span class="n">date</span><span class="p">));</span> <span class="o">--</span> <span class="s2">&quot;2024-05-08&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="translate">
<span class="sig-name descname"><span class="pre">translate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#translate" title="Link to this definition">¶</a></dt>
<dd><p>Returns a new translated string. It translates the character in <code class="docutils literal notranslate"><span class="pre">string</span></code> by a
character in <code class="docutils literal notranslate"><span class="pre">replace</span></code>. The character in <code class="docutils literal notranslate"><span class="pre">replace</span></code> is corresponding to
the character in <code class="docutils literal notranslate"><span class="pre">match</span></code>. The translation will happen when any character
in <code class="docutils literal notranslate"><span class="pre">string</span></code> matching with a character in <code class="docutils literal notranslate"><span class="pre">match</span></code>. If <code class="docutils literal notranslate"><span class="pre">match's</span></code> character
size is larger than <code class="docutils literal notranslate"><span class="pre">replace's</span></code>, the extra characters in <code class="docutils literal notranslate"><span class="pre">match</span></code> will be
removed from <code class="docutils literal notranslate"><span class="pre">string</span></code>. In addition, this function only considers the first
occurrence of a character in <code class="docutils literal notranslate"><span class="pre">match</span></code> and uses its corresponding character in
<code class="docutils literal notranslate"><span class="pre">replace</span></code> for translation.
Any invalid UTF-8 characters present in the input string will be treated as a
single character.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">translate</span><span class="p">(</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span> <span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;1p2rk&quot;</span>
<span class="n">SELECT</span> <span class="n">translate</span><span class="p">(</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span> <span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">);</span>   <span class="o">--</span> <span class="s2">&quot;1prk&quot;</span>
<span class="n">SELECT</span> <span class="n">translate</span><span class="p">(</span><span class="s1">&#39;spark&#39;</span><span class="p">,</span> <span class="s1">&#39;ss&#39;</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">);</span>  <span class="o">--</span> <span class="s2">&quot;1park&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="trim">
<span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#trim" title="Link to this definition">¶</a></dt>
<dd><p>Removes leading and trailing 0x20(space) characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">trim</span><span class="p">(</span><span class="s1">&#39;  data  &#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;data&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark">
<span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trimCharacters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span></dt>
<dd><p>Removes specified leading and trailing characters from <code class="docutils literal notranslate"><span class="pre">string</span></code>.
The specified character is any character contained in <code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code>.
<code class="docutils literal notranslate"><span class="pre">trimCharacters</span></code> can be empty and may contain duplicate characters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">trim</span><span class="p">(</span><span class="s1">&#39;sprk&#39;</span><span class="p">,</span> <span class="s1">&#39;spark&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="s2">&quot;a&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="unbase64">
<span class="sig-name descname"><span class="pre">unbase64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varbinary</span></span></span><a class="headerlink" href="#unbase64" title="Link to this definition">¶</a></dt>
<dd><p>Returns a decoded base64 string as binary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">cast</span><span class="p">(</span><span class="n">unbase64</span><span class="p">(</span><span class="s1">&#39;U3BhcmsgU1FM&#39;</span><span class="p">)</span> <span class="n">AS</span> <span class="n">STRING</span><span class="p">);</span> <span class="o">--</span> <span class="s1">&#39;Spark SQL&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="upper">
<span class="sig-name descname"><span class="pre">upper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">string</span></span></span><a class="headerlink" href="#upper" title="Link to this definition">¶</a></dt>
<dd><p>Returns string with all characters changed to uppercase.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">upper</span><span class="p">(</span><span class="s1">&#39;SparkSql&#39;</span><span class="p">);</span> <span class="o">--</span> <span class="n">SPARKSQL</span>
</pre></div>
</div>
</dd></dl>

<dl class="spark function">
<dt class="sig sig-object spark" id="varchar_type_write_side_check">
<span class="sig-name descname"><span class="pre">varchar_type_write_side_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">varchar</span></span></span><a class="headerlink" href="#varchar_type_write_side_check" title="Link to this definition">¶</a></dt>
<dd><p>Removes trailing space characters (ASCII 32) that exceed the length <code class="docutils literal notranslate"><span class="pre">limit</span></code> from the end of input <code class="docutils literal notranslate"><span class="pre">string</span></code>. <code class="docutils literal notranslate"><span class="pre">limit</span></code> is the maximum length of characters that can be allowed.
Throws exception when <code class="docutils literal notranslate"><span class="pre">string</span></code> still exceeds <code class="docutils literal notranslate"><span class="pre">limit</span></code> after trimming trailing spaces or when <code class="docutils literal notranslate"><span class="pre">limit</span></code> is not greater than 0.
Empty strings are returned as-is since they always satisfy any length <code class="docutils literal notranslate"><span class="pre">limit</span></code> greater than 0.
Note: This function is not directly callable in Spark SQL, but internally used for length check when writing string type columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Function</span> <span class="n">call</span> <span class="n">examples</span> <span class="p">(</span><span class="n">this</span> <span class="n">function</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">directly</span> <span class="nb">callable</span> <span class="ow">in</span> <span class="n">Spark</span> <span class="n">SQL</span><span class="p">)</span><span class="o">.</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abc&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abc   &quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;abc&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;abcd&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;Exceeds allowed length limitation: &#39;3&#39;&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;中国&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;中国&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;中文中国&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;Exceeds allowed length limitation: &#39;3&#39;&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;   &quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">--</span> <span class="n">VeloxUserError</span><span class="p">:</span> <span class="s2">&quot;The length limit must be greater than 0.&quot;</span>
<span class="n">varchar_type_write_side_check</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">String Functions</a><ul>
<li><a class="reference internal" href="#ascii"><code class="docutils literal notranslate"><span class="pre">ascii()</span></code></a></li>
<li><a class="reference internal" href="#base64"><code class="docutils literal notranslate"><span class="pre">base64()</span></code></a></li>
<li><a class="reference internal" href="#bit_length"><code class="docutils literal notranslate"><span class="pre">bit_length()</span></code></a></li>
<li><a class="reference internal" href="#char_type_write_side_check"><code class="docutils literal notranslate"><span class="pre">char_type_write_side_check()</span></code></a></li>
<li><a class="reference internal" href="#chr"><code class="docutils literal notranslate"><span class="pre">chr()</span></code></a></li>
<li><a class="reference internal" href="#concat_ws"><code class="docutils literal notranslate"><span class="pre">concat_ws()</span></code></a></li>
<li><a class="reference internal" href="#contains"><code class="docutils literal notranslate"><span class="pre">contains()</span></code></a></li>
<li><a class="reference internal" href="#conv"><code class="docutils literal notranslate"><span class="pre">conv()</span></code></a></li>
<li><a class="reference internal" href="#empty2null"><code class="docutils literal notranslate"><span class="pre">empty2null()</span></code></a></li>
<li><a class="reference internal" href="#endswith"><code class="docutils literal notranslate"><span class="pre">endswith()</span></code></a></li>
<li><a class="reference internal" href="#find_in_set"><code class="docutils literal notranslate"><span class="pre">find_in_set()</span></code></a></li>
<li><a class="reference internal" href="#initcap"><code class="docutils literal notranslate"><span class="pre">initcap()</span></code></a></li>
<li><a class="reference internal" href="#instr"><code class="docutils literal notranslate"><span class="pre">instr()</span></code></a></li>
<li><a class="reference internal" href="#left"><code class="docutils literal notranslate"><span class="pre">left()</span></code></a></li>
<li><a class="reference internal" href="#length"><code class="docutils literal notranslate"><span class="pre">length()</span></code></a></li>
<li><a class="reference internal" href="#levenshtein"><code class="docutils literal notranslate"><span class="pre">levenshtein()</span></code></a></li>
<li><a class="reference internal" href="#locate"><code class="docutils literal notranslate"><span class="pre">locate()</span></code></a></li>
<li><a class="reference internal" href="#lower"><code class="docutils literal notranslate"><span class="pre">lower()</span></code></a></li>
<li><a class="reference internal" href="#lpad"><code class="docutils literal notranslate"><span class="pre">lpad()</span></code></a></li>
<li><a class="reference internal" href="#ltrim"><code class="docutils literal notranslate"><span class="pre">ltrim()</span></code></a></li>
<li><a class="reference internal" href="#luhn_check"><code class="docutils literal notranslate"><span class="pre">luhn_check()</span></code></a></li>
<li><a class="reference internal" href="#mask"><code class="docutils literal notranslate"><span class="pre">mask()</span></code></a></li>
<li><a class="reference internal" href="#overlay"><code class="docutils literal notranslate"><span class="pre">overlay()</span></code></a></li>
<li><a class="reference internal" href="#read_side_padding"><code class="docutils literal notranslate"><span class="pre">read_side_padding()</span></code></a></li>
<li><a class="reference internal" href="#repeat"><code class="docutils literal notranslate"><span class="pre">repeat()</span></code></a></li>
<li><a class="reference internal" href="#replace"><code class="docutils literal notranslate"><span class="pre">replace()</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">replace()</span></code></a></li>
<li><a class="reference internal" href="#reverse"><code class="docutils literal notranslate"><span class="pre">reverse()</span></code></a></li>
<li><a class="reference internal" href="#rpad"><code class="docutils literal notranslate"><span class="pre">rpad()</span></code></a></li>
<li><a class="reference internal" href="#rtrim"><code class="docutils literal notranslate"><span class="pre">rtrim()</span></code></a></li>
<li><a class="reference internal" href="#soundex"><code class="docutils literal notranslate"><span class="pre">soundex()</span></code></a></li>
<li><a class="reference internal" href="#split"><code class="docutils literal notranslate"><span class="pre">split()</span></code></a></li>
<li><a class="reference internal" href="#startswith"><code class="docutils literal notranslate"><span class="pre">startswith()</span></code></a></li>
<li><a class="reference internal" href="#str_to_map"><code class="docutils literal notranslate"><span class="pre">str_to_map()</span></code></a></li>
<li><a class="reference internal" href="#substring"><code class="docutils literal notranslate"><span class="pre">substring()</span></code></a></li>
<li><a class="reference internal" href="#substring_index"><code class="docutils literal notranslate"><span class="pre">substring_index()</span></code></a></li>
<li><a class="reference internal" href="#to_pretty_string"><code class="docutils literal notranslate"><span class="pre">to_pretty_string()</span></code></a></li>
<li><a class="reference internal" href="#translate"><code class="docutils literal notranslate"><span class="pre">translate()</span></code></a></li>
<li><a class="reference internal" href="#trim"><code class="docutils literal notranslate"><span class="pre">trim()</span></code></a></li>
<li><a class="reference internal" href="#unbase64"><code class="docutils literal notranslate"><span class="pre">unbase64()</span></code></a></li>
<li><a class="reference internal" href="#upper"><code class="docutils literal notranslate"><span class="pre">upper()</span></code></a></li>
<li><a class="reference internal" href="#varchar_type_write_side_check"><code class="docutils literal notranslate"><span class="pre">varchar_type_write_side_check()</span></code></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="comparison.html"
                          title="previous chapter">Comparison Functions</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="datetime.html"
                          title="next chapter">Date and Time Functions</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/functions/spark/string.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="datetime.html" title="Date and Time Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="comparison.html" title="Comparison Functions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Velox  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../spark_functions.html" >Spark Functions</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">String Functions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright TBD.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>