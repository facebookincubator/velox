\hypertarget{pyvelox_8h_source}{}\doxysection{pyvelox.\+h}
\label{pyvelox_8h_source}\index{/home/asus/github/fork/velox/pyvelox/pyvelox.h@{/home/asus/github/fork/velox/pyvelox/pyvelox.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * Copyright (c) Facebook, Inc. and its affiliates.}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ * Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{ * you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{ * You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ *     http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{11 \textcolor{comment}{ * distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{12 \textcolor{comment}{ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{13 \textcolor{comment}{ * See the License for the specific language governing permissions and}}
\DoxyCodeLine{14 \textcolor{comment}{ * limitations under the License.}}
\DoxyCodeLine{15 \textcolor{comment}{ */}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <pybind11/pybind11.h>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <pybind11/stl.h>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <pybind11/stl\_bind.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <velox/type/Type.h>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}folly/json.h"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }facebook::velox::py \{}
\DoxyCodeLine{26 }
\DoxyCodeLine{32 }
\DoxyCodeLine{34 std::string \mbox{\hyperlink{group__pyvelox-type-serialization_gabc79f16e7823ab840cb02f08d4c578d1}{serializeType}}(\textcolor{keyword}{const} std::shared\_ptr<const velox::Type>\& type);}
\DoxyCodeLine{35 }
\DoxyCodeLine{48 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{group__pyvelox-type-serialization_gacb67e389d06aff815aa745a0221f5a56}{addVeloxBindings}}(pybind11::module\& m, \textcolor{keywordtype}{bool} asLocalModule = \textcolor{keyword}{true}) \{}
\DoxyCodeLine{49   \textcolor{comment}{// Inlining these bindings since adding them to the cpp file results in a}}
\DoxyCodeLine{50   \textcolor{comment}{// ASAN error.}}
\DoxyCodeLine{51   \textcolor{keyword}{using namespace }velox;}
\DoxyCodeLine{52   \textcolor{keyword}{namespace }py = pybind11;}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{comment}{// Add TypeKind enum.}}
\DoxyCodeLine{55   py::enum\_<velox::TypeKind>(m, \textcolor{stringliteral}{"{}TypeKind"{}}, py::module\_local(asLocalModule))}
\DoxyCodeLine{56       .value(\textcolor{stringliteral}{"{}BOOLEAN"{}}, velox::TypeKind::BOOLEAN)}
\DoxyCodeLine{57       .value(\textcolor{stringliteral}{"{}TINYINT"{}}, velox::TypeKind::TINYINT)}
\DoxyCodeLine{58       .value(\textcolor{stringliteral}{"{}SMALLINT"{}}, velox::TypeKind::SMALLINT)}
\DoxyCodeLine{59       .value(\textcolor{stringliteral}{"{}INTEGER"{}}, velox::TypeKind::INTEGER)}
\DoxyCodeLine{60       .value(\textcolor{stringliteral}{"{}BIGINT"{}}, velox::TypeKind::BIGINT)}
\DoxyCodeLine{61       .value(\textcolor{stringliteral}{"{}REAL"{}}, velox::TypeKind::REAL)}
\DoxyCodeLine{62       .value(\textcolor{stringliteral}{"{}DOUBLE"{}}, velox::TypeKind::DOUBLE)}
\DoxyCodeLine{63       .value(\textcolor{stringliteral}{"{}VARCHAR"{}}, velox::TypeKind::VARCHAR)}
\DoxyCodeLine{64       .value(\textcolor{stringliteral}{"{}VARBINARY"{}}, velox::TypeKind::VARBINARY)}
\DoxyCodeLine{65       .value(\textcolor{stringliteral}{"{}TIMESTAMP"{}}, velox::TypeKind::TIMESTAMP)}
\DoxyCodeLine{66       .value(\textcolor{stringliteral}{"{}OPAQUE"{}}, velox::TypeKind::OPAQUE)}
\DoxyCodeLine{67       .value(\textcolor{stringliteral}{"{}ARRAY"{}}, velox::TypeKind::ARRAY)}
\DoxyCodeLine{68       .value(\textcolor{stringliteral}{"{}MAP"{}}, velox::TypeKind::MAP)}
\DoxyCodeLine{69       .value(\textcolor{stringliteral}{"{}ROW"{}}, velox::TypeKind::ROW)}
\DoxyCodeLine{70       .export\_values();}
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{comment}{// Create VeloxType bound to velox::Type.}}
\DoxyCodeLine{73   py::class\_<Type, std::shared\_ptr<Type>> type(}
\DoxyCodeLine{74       m, \textcolor{stringliteral}{"{}VeloxType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{75 }
\DoxyCodeLine{76   \textcolor{comment}{// Adding all the derived types of Type here.}}
\DoxyCodeLine{77   py::class\_<BooleanType, Type, std::shared\_ptr<BooleanType>> booleanType(}
\DoxyCodeLine{78       m, \textcolor{stringliteral}{"{}BooleanType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{79   py::class\_<IntegerType, Type, std::shared\_ptr<IntegerType>> integerType(}
\DoxyCodeLine{80       m, \textcolor{stringliteral}{"{}IntegerType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{81   py::class\_<BigintType, Type, std::shared\_ptr<BigintType>> bigintType(}
\DoxyCodeLine{82       m, \textcolor{stringliteral}{"{}BigintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{83   py::class\_<SmallintType, Type, std::shared\_ptr<SmallintType>> smallintType(}
\DoxyCodeLine{84       m, \textcolor{stringliteral}{"{}SmallintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{85   py::class\_<TinyintType, Type, std::shared\_ptr<TinyintType>> tinyintType(}
\DoxyCodeLine{86       m, \textcolor{stringliteral}{"{}TinyintType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{87   py::class\_<RealType, Type, std::shared\_ptr<RealType>> realType(}
\DoxyCodeLine{88       m, \textcolor{stringliteral}{"{}RealType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{89   py::class\_<DoubleType, Type, std::shared\_ptr<DoubleType>> doubleType(}
\DoxyCodeLine{90       m, \textcolor{stringliteral}{"{}DoubleType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{91   py::class\_<TimestampType, Type, std::shared\_ptr<TimestampType>> timestampType(}
\DoxyCodeLine{92       m, \textcolor{stringliteral}{"{}TimestampType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{93   py::class\_<VarcharType, Type, std::shared\_ptr<VarcharType>> varcharType(}
\DoxyCodeLine{94       m, \textcolor{stringliteral}{"{}VarcharType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{95   py::class\_<VarbinaryType, Type, std::shared\_ptr<VarbinaryType>> varbinaryType(}
\DoxyCodeLine{96       m, \textcolor{stringliteral}{"{}VarbinaryType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{97   py::class\_<ArrayType, Type, std::shared\_ptr<ArrayType>> arrayType(}
\DoxyCodeLine{98       m, \textcolor{stringliteral}{"{}ArrayType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{99   py::class\_<MapType, Type, std::shared\_ptr<MapType>> mapType(}
\DoxyCodeLine{100       m, \textcolor{stringliteral}{"{}MapType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{101   py::class\_<RowType, Type, std::shared\_ptr<RowType>> rowType(}
\DoxyCodeLine{102       m, \textcolor{stringliteral}{"{}RowType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{103   py::class\_<FixedSizeArrayType, Type, std::shared\_ptr<FixedSizeArrayType>>}
\DoxyCodeLine{104       fixedArrayType(m, \textcolor{stringliteral}{"{}FixedSizeArrayType"{}}, py::module\_local(asLocalModule));}
\DoxyCodeLine{105 }
\DoxyCodeLine{106   \textcolor{comment}{// Basic operations on Type.}}
\DoxyCodeLine{107   type.def(\textcolor{stringliteral}{"{}\_\_str\_\_"{}}, \&Type::toString);}
\DoxyCodeLine{108   \textcolor{comment}{// Gcc doesnt support the below kind of templatization.}}
\DoxyCodeLine{109 \textcolor{preprocessor}{\#if defined(\_\_clang\_\_)}}
\DoxyCodeLine{110   \textcolor{comment}{// Adds equality and inequality comparison operators.}}
\DoxyCodeLine{111   type.def(py::self == py::self);}
\DoxyCodeLine{112   type.def(py::self != py::self);}
\DoxyCodeLine{113 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{114   type.def(}
\DoxyCodeLine{115       \textcolor{stringliteral}{"{}cpp\_size\_in\_bytes"{}},}
\DoxyCodeLine{116       \&Type::cppSizeInBytes,}
\DoxyCodeLine{117       \textcolor{stringliteral}{"{}Return the C++ size in bytes"{}});}
\DoxyCodeLine{118   type.def(}
\DoxyCodeLine{119       \textcolor{stringliteral}{"{}is\_fixed\_width"{}},}
\DoxyCodeLine{120       \&Type::isFixedWidth,}
\DoxyCodeLine{121       \textcolor{stringliteral}{"{}Check if the type is fixed width"{}});}
\DoxyCodeLine{122   type.def(}
\DoxyCodeLine{123       \textcolor{stringliteral}{"{}is\_primitive\_type"{}},}
\DoxyCodeLine{124       \&Type::isPrimitiveType,}
\DoxyCodeLine{125       \textcolor{stringliteral}{"{}Check if the type is a primitive type"{}});}
\DoxyCodeLine{126   type.def(\textcolor{stringliteral}{"{}kind"{}}, \&Type::kind, \textcolor{stringliteral}{"{}Returns the kind of the type"{}});}
\DoxyCodeLine{127   type.def(\textcolor{stringliteral}{"{}serialize"{}}, \&\mbox{\hyperlink{group__pyvelox-type-serialization_gabc79f16e7823ab840cb02f08d4c578d1}{serializeType}}, \textcolor{stringliteral}{"{}Serializes the type as JSON"{}});}
\DoxyCodeLine{128 }
\DoxyCodeLine{129   booleanType.def(py::init());}
\DoxyCodeLine{130   tinyintType.def(py::init());}
\DoxyCodeLine{131   smallintType.def(py::init());}
\DoxyCodeLine{132   integerType.def(py::init());}
\DoxyCodeLine{133   bigintType.def(py::init());}
\DoxyCodeLine{134   realType.def(py::init());}
\DoxyCodeLine{135   doubleType.def(py::init());}
\DoxyCodeLine{136   varcharType.def(py::init());}
\DoxyCodeLine{137   varbinaryType.def(py::init());}
\DoxyCodeLine{138   timestampType.def(py::init());}
\DoxyCodeLine{139   arrayType.def(py::init<std::shared\_ptr<Type>>());}
\DoxyCodeLine{140   arrayType.def(}
\DoxyCodeLine{141       \textcolor{stringliteral}{"{}element\_type"{}}, \&ArrayType::elementType, \textcolor{stringliteral}{"{}Return the element type"{}});}
\DoxyCodeLine{142   fixedArrayType.def(py::init<int, velox::TypePtr>())}
\DoxyCodeLine{143       .def(\textcolor{stringliteral}{"{}element\_type"{}}, \&velox::FixedSizeArrayType::elementType)}
\DoxyCodeLine{144       .def(\textcolor{stringliteral}{"{}fixed\_width"{}}, \&velox::FixedSizeArrayType::fixedElementsWidth);}
\DoxyCodeLine{145   mapType.def(py::init<std::shared\_ptr<Type>, std::shared\_ptr<Type>>());}
\DoxyCodeLine{146   mapType.def(\textcolor{stringliteral}{"{}key\_type"{}}, \&MapType::keyType, \textcolor{stringliteral}{"{}Return the key type"{}});}
\DoxyCodeLine{147   mapType.def(\textcolor{stringliteral}{"{}value\_type"{}}, \&MapType::valueType, \textcolor{stringliteral}{"{}Return the value type"{}});}
\DoxyCodeLine{148 }
\DoxyCodeLine{149   rowType.def(py::init<}
\DoxyCodeLine{150               std::vector<std::string>,}
\DoxyCodeLine{151               std::vector<std::shared\_ptr<const Type>>>());}
\DoxyCodeLine{152   rowType.def(\textcolor{stringliteral}{"{}size"{}}, \&RowType::size, \textcolor{stringliteral}{"{}Return the number of columns"{}});}
\DoxyCodeLine{153   rowType.def(}
\DoxyCodeLine{154       \textcolor{stringliteral}{"{}child\_at"{}},}
\DoxyCodeLine{155       \&RowType::childAt,}
\DoxyCodeLine{156       \textcolor{stringliteral}{"{}Return the type of the column at a given index"{}},}
\DoxyCodeLine{157       py::arg(\textcolor{stringliteral}{"{}idx"{}}));}
\DoxyCodeLine{158   rowType.def(}
\DoxyCodeLine{159       \textcolor{stringliteral}{"{}find\_child"{}},}
\DoxyCodeLine{160       [](\textcolor{keyword}{const} std::shared\_ptr<RowType>\& type, \textcolor{keyword}{const} std::string\& name) \{}
\DoxyCodeLine{161         \textcolor{keywordflow}{return} type-\/>findChild(name);}
\DoxyCodeLine{162       \},}
\DoxyCodeLine{163       \textcolor{stringliteral}{"{}Return the type of the column with the given name"{}},}
\DoxyCodeLine{164       py::arg(\textcolor{stringliteral}{"{}name"{}}));}
\DoxyCodeLine{165   rowType.def(}
\DoxyCodeLine{166       \textcolor{stringliteral}{"{}get\_child\_idx"{}},}
\DoxyCodeLine{167       \&RowType::getChildIdx,}
\DoxyCodeLine{168       \textcolor{stringliteral}{"{}Return the index of the column with the given name"{}},}
\DoxyCodeLine{169       py::arg(\textcolor{stringliteral}{"{}name"{}}));}
\DoxyCodeLine{170   rowType.def(}
\DoxyCodeLine{171       \textcolor{stringliteral}{"{}name\_of"{}},}
\DoxyCodeLine{172       \&RowType::nameOf,}
\DoxyCodeLine{173       \textcolor{stringliteral}{"{}Return the name of the column at the given index"{}},}
\DoxyCodeLine{174       py::arg(\textcolor{stringliteral}{"{}idx"{}}));}
\DoxyCodeLine{175   rowType.def(\textcolor{stringliteral}{"{}names"{}}, \&RowType::names, \textcolor{stringliteral}{"{}Return the names of the columns"{}});}
\DoxyCodeLine{176 \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \} \textcolor{comment}{// namespace facebook::velox::py}}

\end{DoxyCode}
